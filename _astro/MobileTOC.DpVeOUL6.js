import{o as he,i as be,a as we}from"./config.DRw9eTPC.js";import{f as p,i as K,t as C,j as L,a as f,p as ge,b as _e,g as o,m as A,c as d,s as g,d as _,r as l,k as G,n as J}from"./utils.DXn1uca8.js";import{s as S}from"./render.Hq3A0QE5.js";import{I as x,i as y}from"./Icon.BS5pZSMo.js";import{e as Q,i as U}from"./each.CL1XgCbk.js";import{I as W}from"./zh_TW.BpWIkrso.js";import{i as X}from"./translation.Yrl9oLo2.js";import{n as xe}from"./navigation-utils.Cc6bKnia.js";/* empty css                        */var ye=p('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>暂无文章</p></div>'),Ie=p('<div class="post-category svelte-cz3h3s"> </div>'),ke=p('<button class="post-item svelte-cz3h3s"><div class="post-title svelte-cz3h3s"><!> </div> <!></button>'),Te=p('<div class="post-content svelte-cz3h3s"></div>'),Ee=p('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>当前页面没有目录</p></div>'),Ce=p('<button><span class="toc-text svelte-cz3h3s"> </span></button>'),Le=p('<div class="toc-content svelte-cz3h3s"></div>'),Ae=p(`<button aria-label="Table of Contents" id="mobile-toc-switch" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 lg:!hidden"><!></button> <div id="mobile-toc-panel" class="float-panel float-panel-closed mobile-toc-panel absolute md:w-[20rem] w-[calc(100vw-2rem)]
		top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-4 svelte-cz3h3s"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-bold text-[var(--primary)]"> </h3> <button aria-label="Close TOC" class="btn-plain rounded-lg h-8 w-8 active:scale-90"><!></button></div> <!></div>`,1);function Ne(Z,$){_e($,!1);let z=A([]),P=A([]),I=A(""),h,k=A(!1),T=!1;const R=()=>{document.getElementById("mobile-toc-panel")?.classList.toggle("float-panel-closed")},V=e=>{const t=document.getElementById("mobile-toc-panel");t&&t.classList.add("float-panel-closed")},ee=()=>{const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),t=[];e.forEach(a=>{if(a.id){const i=Number.parseInt(a.tagName.charAt(1)),v=(a.textContent||"").replace(/#+\s*$/,"");t.push({id:a.id,text:v,level:i})}}),g(z,t)},te=()=>{const e=document.querySelectorAll(".card-base"),t=[];e.forEach(a=>{const i=a.querySelector('a[href*="/posts/"].transition.group'),v=a.querySelector('a[href*="/categories/"].link-lg'),n=i?.querySelector('svg[data-icon="mdi:pin"]');if(i){const s=i.getAttribute("href"),m=i.textContent?.replace(/\s+/g," ").trim()||"",r=v?.textContent?.trim()||"",c=!!n;s&&m&&t.push({title:m,url:s,category:r,pinned:c})}}),g(P,t)},oe=()=>{g(k,window.location.pathname==="/"||window.location.pathname==="")},se=e=>{const t=document.getElementById(e);if(t){V();const i=t.offsetTop-80;window.scrollTo({top:i,behavior:"smooth"})}},ae=e=>{V(),xe(e)},q=()=>{const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),t=window.scrollY,a=100;let i="";e.forEach(v=>{if(v.id){const n=v.offsetTop-a;t>=n&&(i=v.id)}}),g(I,i)},ne=()=>{const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6");h&&h.disconnect(),h=new IntersectionObserver(t=>{t.forEach(a=>{a.isIntersecting&&g(I,a.target.id)})},{rootMargin:"-80px 0px -80% 0px",threshold:0}),e.forEach(t=>{t.id&&h.observe(t)})},ie=()=>{if(typeof window<"u"&&(T=!!window.swup,!T)){const e=()=>{window.swup&&(T=!0,document.removeEventListener("swup:enable",e))};document.addEventListener("swup:enable",e),setTimeout(()=>{window.swup&&(T=!0,document.removeEventListener("swup:enable",e))},1e3)}},Y=()=>{oe(),ie(),o(k)?te():(ee(),ne(),q())};he(()=>(setTimeout(Y,100),window.addEventListener("scroll",q),()=>{h&&h.disconnect(),window.removeEventListener("scroll",q)})),typeof window<"u"&&(window.mobileTOCInit=Y),be();var D=Ae(),E=K(D),le=d(E);x(le,{icon:"material-symbols:format-list-bulleted",class:"text-[1.25rem]"}),l(E);var F=_(E,2),O=d(F),H=d(O),re=d(H,!0);l(H);var B=_(H,2),ce=d(B);x(ce,{icon:"material-symbols:close",class:"text-[1rem]"}),l(B),l(O);var de=_(O,2);{var ve=e=>{var t=G(),a=K(t);{var i=n=>{var s=ye(),m=d(s);x(m,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),J(2),l(s),f(n,s)},v=n=>{var s=Te();Q(s,5,()=>o(P),U,(m,r)=>{var c=ke(),b=d(c),w=d(b);{var M=u=>{x(u,{icon:"mdi:pin",class:"pinned-icon"})};y(w,u=>{o(r).pinned&&u(M)})}var j=_(w);l(b);var fe=_(b,2);{var pe=u=>{var N=Ie(),ue=d(N,!0);l(N),C(()=>S(ue,o(r).category)),f(u,N)};y(fe,u=>{o(r).category&&u(pe)})}l(c),C(()=>S(j,` ${o(r).title??""}`)),L("click",c,()=>ae(o(r).url)),f(m,c)}),l(s),f(n,s)};y(a,n=>{o(P).length===0?n(i):n(v,!1)})}f(e,t)},me=e=>{var t=G(),a=K(t);{var i=n=>{var s=Ee(),m=d(s);x(m,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),J(2),l(s),f(n,s)},v=n=>{var s=Le();Q(s,5,()=>o(z),U,(m,r)=>{var c=Ce();let b;var w=d(c),M=d(w,!0);l(w),l(c),C(j=>{b=we(c,1,`toc-item level-${o(r).level??""} ${o(I)===o(r).id?"active":""}`,"svelte-cz3h3s",b,j),S(M,o(r).text)},[()=>({active:o(I)===o(r).id})]),L("click",c,()=>se(o(r).id)),f(m,c)}),l(s),f(n,s)};y(a,n=>{o(z).length===0?n(i):n(v,!1)})}f(e,t)};y(de,e=>{o(k)?e(ve):e(me,!1)})}l(F),C(e=>S(re,e),[()=>o(k)?X(W.postList):X(W.tableOfContents)]),L("click",E,R),L("click",B,R),f(Z,D),ge()}export{Ne as default};
